<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Readme - cwserver</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/4.0.0/github-markdown.min.css" />
    <style type="text/css">
        code {
            color: #c7254e;
            background-color: #f9f2f4;
            border-radius: 4px;
        }

        pre code {
            padding: 0;
            font-size: inherit;
            color: inherit;
            white-space: pre-wrap;
            background-color: transparent;
            border-radius: 0;
        }

        .markdown-body {
            box-sizing: border-box;
            min-width: 200px;
            max-width: 980px;
            margin: 0 auto;
            padding: 45px;
        }

            .markdown-body .highlight pre, .markdown-body pre {
                padding: 1px !important;
            }

        @media (max-width: 767px) {
            .markdown-body {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <article class="markdown-body entry-content container-lg" itemprop="text">
        <p><a href="http://cwserver.safeonline.world/" rel="nofollow"><img src="https://camo.githubusercontent.com/2d74d1ced4b061d24dbe491ba78c6a79227ec47f/68747470733a2f2f692e696d6775722e636f6d2f6550513332786f2e706e67" alt="Cwserver Logo" data-canonical-src="https://i.imgur.com/ePQ32xo.png" style="max-width:100%;"></a></p>
        <p>
            <a href="https://travis-ci.org/github/safeonlineworld/cwserver" rel="nofollow"><img src="https://camo.githubusercontent.com/3a5223f8ad91c12f8df7e0edb1a415120a839a21/68747470733a2f2f696d672e736869656c64732e696f2f7472617669732f736166656f6e6c696e65776f726c642f63777365727665722f6d61737465722e7376673f6c6162656c3d6c696e7578" alt="Linux Build" data-canonical-src="https://img.shields.io/travis/safeonlineworld/cwserver/master.svg?label=linux" style="max-width:100%;"></a>
            <a href="https://ci.appveyor.com/project/rktuxyn/cwserver" rel="nofollow"><img src="https://camo.githubusercontent.com/ef1bd0dd8762ce41a3fc8149934b38435cbbbf19/68747470733a2f2f696d672e736869656c64732e696f2f6170707665796f722f6275696c642f726b747578796e2f63777365727665722f6d61737465722e7376673f6c6162656c3d77696e646f7773" alt="Windows Build" data-canonical-src="https://img.shields.io/appveyor/build/rktuxyn/cwserver/master.svg?label=windows" style="max-width:100%;"></a>
            <a href="https://badge.fury.io/js/cwserver" rel="nofollow"><img src="https://camo.githubusercontent.com/a163e8dde56818e2b606b75dd6fccf2feed6e5cd/68747470733a2f2f62616467652e667572792e696f2f6a732f63777365727665722e737667" alt="npm version" data-canonical-src="https://badge.fury.io/js/cwserver.svg" style="max-width:100%;"></a>
            <a href="https://npmcharts.com/compare/cwserver?minimal=true" rel="nofollow"><img src="https://camo.githubusercontent.com/c2369ea9f472bd413f21f3624bddae3d487517e1/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f64742f63777365727665722e737667" alt="NPM Downloads" data-canonical-src="https://img.shields.io/npm/dt/cwserver.svg" style="max-width:100%;"></a>
            <a href="https://lgtm.com/projects/g/safeonlineworld/cwserver/context:javascript" rel="nofollow"><img src="https://camo.githubusercontent.com/c553674fe7d2e790cd1e58d6af1710e02ef0b280/68747470733a2f2f696d672e736869656c64732e696f2f6c67746d2f67726164652f6a6176617363726970742f672f736166656f6e6c696e65776f726c642f63777365727665722e7376673f6c6f676f3d6c67746d266c6f676f57696474683d3138" alt="Language grade: JavaScript" data-canonical-src="https://img.shields.io/lgtm/grade/javascript/g/safeonlineworld/cwserver.svg?logo=lgtm&amp;logoWidth=18" style="max-width:100%;"></a>
            <a href="https://coveralls.io/github/safeonlineworld/cwserver?branch=master" rel="nofollow"><img src="https://camo.githubusercontent.com/26ef5c4c9f438e9ad5fd94dae2cb67e6b0ec452f/68747470733a2f2f696d672e736869656c64732e696f2f636f766572616c6c732f6769746875622f736166656f6e6c696e65776f726c642f63777365727665722f6d6173746572" alt="Coverage Status" data-canonical-src="https://img.shields.io/coveralls/github/safeonlineworld/cwserver/master" style="max-width:100%;"></a>
            <a href="https://snyk.io/test/github/safeonlineworld/cwserver?targetFile=package.json" rel="nofollow"><img src="https://camo.githubusercontent.com/d6a601303f8fbb86713a9be4377a34c25a00b9a3/68747470733a2f2f736e796b2e696f2f746573742f6769746875622f736166656f6e6c696e65776f726c642f63777365727665722f62616467652e7376673f74617267657446696c653d7061636b6167652e6a736f6e" alt="Known Vulnerabilities" data-canonical-src="https://snyk.io/test/github/safeonlineworld/cwserver/badge.svg?targetFile=package.json" style="max-width:100%;"></a>
            <a href="https://david-dm.org/safeonlineworld/cwserver" rel="nofollow"><img src="https://camo.githubusercontent.com/dd738401314ba54e966d3b49ba7f7f150dab2ec5/68747470733a2f2f696d672e736869656c64732e696f2f64617669642f736166656f6e6c696e65776f726c642f6377736572766572" alt="Dependency Status" data-canonical-src="https://img.shields.io/david/safeonlineworld/cwserver" style="max-width:100%;"></a>
            <a href="https://david-dm.org/safeonlineworld/cwserver?type=dev" rel="nofollow"><img src="https://camo.githubusercontent.com/e4f52d4012de119a71f122bac6d419dfbd8a6578/68747470733a2f2f696d672e736869656c64732e696f2f64617669642f6465762f736166656f6e6c696e65776f726c642f6377736572766572" alt="devDependency Status" data-canonical-src="https://img.shields.io/david/dev/safeonlineworld/cwserver" style="max-width:100%;"></a>
        </p>
        <h2><a id="user-content-cwserver" class="anchor" aria-hidden="true" href="#cwserver"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>cwserver</h2>
        <p>The aim of the project is to create an easy to use, lightweight, <code>Complete Web Server Framework</code> with default <code>NodeJs HTTP Server</code>.</p>
        <ul>
            <li>
                The framework also provides default
                <ul>
                    <li><code>Secure User Session</code>,</li>
                    <li><code>Cookie Parser</code>,</li>
                    <li><code>Flexible Router</code>,</li>
                    <li><code>Multiple Views</code>,</li>
                    <li><code>Virtual Directory</code>,</li>
                    <li><code>Hidden Directory</code>,</li>
                    <li><code>Template Engine</code>,</li>
                    <li><code>Nested Master Template Engine</code>,</li>
                    <li><code>Post Data Handler (with multipart form data and large file)</code>,</li>
                    <li><code>Mimetype Handler</code>,</li>
                    <li><code>WebStream Handler</code>,</li>
                    <li><code>JS/CSS Bundler</code>,</li>
                    <li><code>socket.io Interface</code>,</li>
                    <li><code>Easy way to bind with IIS/NGINX</code></li>
                </ul>
            </li>
        </ul>
        <p>
            Install <code>cwserver</code> by this command <code>npm i cwserver</code><br>
            Create <code>createProjectTemplate.js</code> as following
        </p>
        <pre><code>
const { createProjectTemplate } = require( 'cwserver' );
createProjectTemplate( {
    appRoot: __dirname,
    projectRoot: "www" /** Your project root folder name*/,
    allExample: false
} );
        </code></pre>
        <p>
            Then run this commmand <code>node createProjectTemplate</code><br>
            It will create default project template for <code>cwserver</code> in your application root.<br>
            Now your appRoot look like this
        </p>
        <pre><code>
appRoot 
├─┬ wwww ( projectRoot )
│ └─┬ config
│   ├ lib
│   ├ template (this contains master template file)
│   ├ web (this contains temp and cache files)
│   └ index.html
├─ node_modules
├─ server.js
├─ package.json
└─ README.md
        </code></pre>
        <p>After, run this command <code>node server www /**your project root*/</code><br></p>
        <h3><a id="user-content-how-to-setup-middleware" class="anchor" aria-hidden="true" href="#how-to-setup-middleware"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How to setup middleware</h3>
        <p>First process <code>app.prerequisites</code> every request and then run <code>app.use</code></p>
        <pre><code>
global.sow.server.on( "register-view", ( app, controller, server ) =&gt; {
    app.prerequisites( ( req, res, next ): void =&gt; {
        res.setHeader( 'x-frame-options', 'sameorigin' );
        return next();
    } );
    app.use( ( req, res, next ): void =&gt; {
        res.setHeader( 'x-frame-options', 'sameorigin' );
        return next();
    } );
} );
        </code></pre>
        <h3><a id="user-content-how-to-setup-router-" class="anchor" aria-hidden="true" href="#how-to-setup-router-"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How to setup router ?</h3>
        <pre><code>
global.sow.server.on( "register-view", ( app, controller, server ) =&gt; {
    controller
        .any( '/test-any/*', ( ctx, match ) =&gt; {
            return ctx.res.json( { reqPath: ctx.path, servedFrom: "/test-any/*", q: match } );
        } )
        .get( '/task/:id/*', ( ctx, match ) =&gt; {
            return ctx.res.json( { reqPath: ctx.path, servedFrom: "/task/:id/*", q: match } );
        } )
        .get( '/dist/*', ( ctx, match ) =&gt; {
            return ctx.res.json( { reqPath: ctx.path, servedFrom: "/dist/*", q: match } );
        } )
        .get( '/user/:id/settings', ( ctx, match ) =&gt; {
            return ctx.res.json( { reqPath: ctx.path, servedFrom: "/user/:id/settings", q: match } );
        } );
} );
        </code></pre>
        <h3><a id="user-content-how-to-add-virtual-directory-" class="anchor" aria-hidden="true" href="#how-to-add-virtual-directory-"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>How to add Virtual Directory ?</h3>
        <pre><code>
global.sow.server.on( "register-view", ( app, controller, server ) =&gt; {
    const vDir = path.join( path.resolve( server.getRoot(), '..' ), "/project_template/test/" );
    server.addVirtualDir( "/vtest", vDir, ( ctx ) =&gt; {
        return mimeHandler.render( ctx, vDir, true );
    } );
    server.addVirtualDir( "/test-virtual", vDir );
    server.addVirtualDir( "/vtest/virtual/", vDir );
} );
        </code></pre>
        <h3><a id="user-content-handle-post-data" class="anchor" aria-hidden="true" href="#handle-post-data"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Handle post data</h3>
        <pre><code>
global.sow.server.on( "register-view", ( app, controller, server ) =&gt; {
    const downloadDir = server.mapPath( "/upload/data/" );
    if ( !fs.existsSync( downloadDir ) ) {
        Util.mkdirSync( server.mapPath( "/" ), "/upload/data/" );
    }
    const tempDir = server.mapPath( "/upload/temp/" );
    controller.post( '/post-async', async ( ctx ) =&gt; {
        const parser = new PayloadParser( ctx.req, tempDir );
        await parser.readDataAsync();
        if ( parser.isUrlEncoded() || parser.isAppJson() ) {
            ctx.res.writeHead( 200, { 'Content-Type': 'application/json' } );
            return ctx.res.end( JSON.stringify( parser.getJson() ) ), ctx.next( 200 ), void 0;
        }
        parser.saveAsSync( downloadDir );
        return ctx.res.asHTML( 200 ).end( "&lt;h1&gt;success&lt;/h1&gt;" );
        // or
        /*const data = [];
        parser.getFilesSync( ( file ) =&gt; {
            data.push( {
                content_type: file.getContentType(),
                name: file.getName(),
                file_name: file.getFileName(),
                content_disposition: file.getContentDisposition(),
                file_size: file.getFileSize(),
                temp_path: file.getTempPath()
            } );
            file.saveAsSync( `${downloadDir}/${Util.guid()}_${file.getFileName()}` );
        } );
        return ctx.res.json( data );*/
    } )
} );
        </code></pre>
        <p><a href="https://github.com/safeonlineworld/cwserver/blob/master/test/test-view.ts">See more test here</a><br></p>
        <h3><a id="user-content-template-engine" class="anchor" aria-hidden="true" href="#template-engine"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Template Engine</h3>
        <p>
            Template can run <code>config.defaultExt</code> file extension or <code>ctx.res.render( ctx, to_file_path )</code> <br>
            Example of server-side script in <code>config.defaultExt</code> or <code>.htm|.html</code><br>
        </p>
        <pre><code>ctx.res.render( ctx, server.mapPath( `/index${server.config.defaultExt || ".html"}` ) );
        </code></pre>
        <p>Code block:</p>
        <pre><code>
{%
    if( !ctx.session.isAuthenticated ){
        return ctx.next( 401, true );
    } else {
        ctx.write( JSON.stringify( ctx.session ) );
    }
%}
        </code></pre>
        <p>Response write: <code>{= myVar =}</code> or <code>ctx.write(myVar)</code><br></p>
        <pre><code>
{%
    const result = await ctx.server.db.pgsql.executeIoAsync( "my_shcema.__get_dataset", JSON.stringify( {
        login_id: ctx.req.session.loginId
    } ), JSON.stringify( {
        trade_date: "2020-02-03"
    } ) );
%}
{% if ( result.ret_val &lt; 0) { %}
    &lt;span style="color:red"&gt;No Data Found...&lt;/span&gt;
{% } else { %}
&lt;table style="width:100%"&gt;
    &lt;thead&gt;
        &lt;tr&gt;
            &lt;th&gt;Firstname&lt;/th&gt;
            &lt;th&gt;Lastname&lt;/th&gt;
            &lt;th&gt;Age&lt;/th&gt;
        &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody&gt;
    {% for( const row of result.ret_data_table ){ %}
        &lt;tr&gt;
            &lt;td&gt;{= row.first_name =}&lt;/td&gt;
            &lt;td&gt;{= row.last_name =}&lt;/td&gt;
            &lt;td&gt;{= row.age_name =}&lt;/td&gt;
        &lt;/tr&gt;
    {% } %}
    &lt;/tbody&gt;
&lt;/table&gt;
{% } %}
        </code></pre>
        <h3><a id="user-content-nested-master-template" class="anchor" aria-hidden="true" href="#nested-master-template"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Nested Master Template</h3>
        <p>
            <code>#extends</code> keyword define my master template<br>
            You can add multiple file by <code>#attach</code> keyword
        </p>
        <pre><code>
www
├─┬ template
│ └─┬ master.html 
│   ├ footer.html
│   ├ header.html
│   └ readme.html
├─ index.html

index.html  ==&gt; #extends /template/readme.html
==&gt; index.html impliment placeholder id of readme.html (parent master)
-------------------------------------------
#extends /template/readme.html
&lt;impl-placeholder id="container"&gt;
    container here
&lt;/impl-placeholder&gt;
-------------------------------------------
readme.html ==&gt; #extends /template/master.html (parent master)
==&gt; readme.html like as master template and its contains own placeholder and impliment placeholder id of master.html
-------------------------------------------
#extends /template/master.html
&lt;impl-placeholder id="body"&gt;
    &lt;!--Here create new placeholder--&gt;
    &lt;placeholder id="container"&gt;
    &lt;/placeholder&gt;
&lt;/impl-placeholder&gt;
&lt;impl-placeholder id="header"&gt;
    #attach /template/header.html
&lt;/impl-placeholder&gt;
-------------------------------------------
master.html ==&gt; root master template
--------------------------------------------
&lt;!DOCTYPE html&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;placeholder id="header"&gt;
&lt;/placeholder&gt;
&lt;body&gt;
    &lt;placeholder id="body"&gt;
    &lt;/placeholder&gt;
    #attach /template/footer.html
&lt;/body&gt;
&lt;/html&gt;
--------------------------------------------
        </code></pre>
        <p>see more about template /dist/project_template/www <br><br></p>
        <h3><a id="user-content-serverjs" class="anchor" aria-hidden="true" href="#serverjs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>server.js</h3>
        <p>You may create server.js file by you:</p>
        <pre><code>
const { ConsoleColor, initilizeServer } = require( 'cwserver' );
let wwwName = void 0;
if ( process.argv.length &gt; 2 ) {
    wwwName = process.argv[2];
} else {
    if ( process.env.APP_POOL_ID ) {
        wwwName = process.env[process.env.APP_POOL_ID];
    }
}
const server = initilizeServer( __dirname, wwwName );
const app = server.init();
process.on( 'exit', () =&gt; {
    console.log( "Exited..." );
} );
process.on( 'SIGINT', () =&gt; {
    server.log.error( "Caught interrupt signal" );
    server.log.error( "Application Exited..." );
    server.log.reset(); server.log.dispose();
    setTimeout( () =&gt; {
        process.exit( 0 );
    }, 200 );
} );
app.listen( server.port, () =&gt; server.log.write( `
    [+] Maintance      : https://www.safeonline.world
    [+] Server         : http://localhost:${server.port}
    [+] Socket         : ws://localhost:${server.port}${server.socketPath}
    [~] Running Server...
`, ConsoleColor.FgMagenta ) );
        </code></pre>
        <p>
            Read more about <a href="https://github.com/safeonlineworld/cwserver/blob/master/schema.json">app.config.json</a><br>
            run <code>node server your_app_dir_name</code> or <code>npm start your_app_dir_name</code>
        </p>
    </article>
    <script type="text/javascript">
        function docReady( fn ) {
            // see if DOM is already available
            if ( document.readyState === "complete" || document.readyState === "interactive" ) {
                // call on next available tick
                setTimeout( fn, 1 );
            } else {
                document.addEventListener( "DOMContentLoaded", fn );
            }
        };
        docReady( function () {
            document.querySelectorAll( 'a[href^="#"]' ).forEach( function ( item ) {
                item.addEventListener( 'click', function ( e ) {
                    let hashval = item.getAttribute( 'href' );
                    item.scrollIntoView( {
                        behavior: 'smooth',
                        block: 'start'
                    } );
                    history.pushState( null, null, hashval );
                    e.preventDefault();
                } );
            } );
            if ( document.location.hash ) {
                setTimeout( () => {
                    ( function ( elem ) {
                        if ( !elem ) return;
                        elem.click();
                    }( document.querySelector( `[href="${document.location.hash}"]` ) ) );
                }, 100 );
            }
        } );
    </script>
</body>
</html>